% verify_hdl_output.m
% Verify HDL simulation results against MATLAB golden reference

clear all; close all; clc;

fprintf('\n========================================\n');
fprintf('HDL OUTPUT VERIFICATION\n');
fprintf('========================================\n\n');

% Load expected results (golden reference)
expected = [
    500163.485048, 5400831.480178, 108.828576;
    500904.402265, 5400762.085266, 91.865952;
    500276.698085, 5400002.484167, 119.399386;
    500063.741259, 5400940.346489, 113.840581;
    500615.037704, 5400145.878317, 104.933929;
    500366.919589, 5400857.611403, 95.421703;
    500844.561612, 5400890.723570, 85.834460;
    500765.485550, 5400913.047145, 89.536090;
    500870.646291, 5400903.684732, 83.995726;
    500582.832037, 5400238.661177, 107.498801;
    500422.460212, 5400935.660299, 102.906093;
    500122.264639, 5400948.336650, 116.011212;
    500125.114291, 5400977.228839, 115.212059;
    500909.607012, 5400987.464122, 88.116932;
    500109.483392, 5400820.652282, 113.092222;
    500196.610531, 5400236.585936, 98.292229;
    500492.799246, 5400373.854181, 99.743916;
    500980.060741, 5400910.244353, 86.858347;
    500275.312242, 5400032.528266, 115.460810;
    500764.555947, 5400208.020581, 103.173792;
    500417.123097, 5400311.092964, 94.081253;
    500718.727554, 5400791.190173, 107.170703;
    500844.878881, 5400328.516755, 107.758054;
    500856.760470, 5400690.914323, 104.936874;
    500279.422976, 5400458.322283, 93.114982;
    500415.379202, 5400950.977382, 104.878135;
    500561.624325, 5400794.280408, 105.593458;
    500714.480212, 5400220.916010, 108.216513;
    500269.085029, 5400847.461968, 99.198423;
    500118.817058, 5400850.402896, 114.457912;
    500932.261889, 5400833.373863, 83.848462;
    500546.614711, 5400581.751157, 100.454813;
    500623.519721, 5400530.538176, 100.551591;
    500040.832059, 5400070.033076, 113.112419;
    500757.229194, 5400856.360321, 97.240519;
    500510.171004, 5400981.611133, 98.979077;
    500576.567971, 5400065.279040, 97.227789;
    500767.593923, 5400171.047219, 99.235806;
    500941.005943, 5400716.872609, 95.697864;
    500312.565770, 5400562.619674, 95.153966;
    500574.834368, 5400733.168590, 106.647087;
    500109.070987, 5400040.323403, 115.124219;
    500839.702172, 5400910.635741, 85.020574;
    500059.441711, 5400465.569504, 80.849236;
    500097.941820, 5400093.343085, 116.570770;
    500738.625822, 5400982.042483, 82.154037;
    500412.089812, 5400555.231223, 99.712146;
    500887.697824, 5400489.689720, 120.249946;
    500134.801655, 5400138.602910, 113.922252;
    500300.610928, 5400479.489358, 95.183677;
    500871.087967, 5400887.549404, 84.436141;
    500642.707514, 5400746.423944, 110.314974;
    500780.127052, 5400787.305095, 101.976340;
    500549.970564, 5400918.076280, 99.370153;
    500356.469671, 5400224.678933, 89.999925;
    500502.629844, 5400590.488341, 100.034108;
    500443.650165, 5400898.818892, 99.389505;
    500528.684449, 5400302.690633, 102.304065;
    500650.442400, 5400375.665619, 105.753815;
    500928.161169, 5400587.431917, 115.364855;
    500002.187033, 5400938.823106, 108.420098;
    500414.565899, 5400002.085767, 110.006501;
    500747.300241, 5400881.131258, 95.109747;
    500807.740135, 5400723.768962, 104.898523;
    500422.852542, 5400159.036805, 95.106147;
    500747.362787, 5400931.849652, 88.320426;
    500643.236602, 5400519.760512, 101.171082;
    500928.613017, 5400305.804094, 99.972101;
    500831.541329, 5400888.836831, 86.875439;
    500535.822827, 5400775.849699, 103.526912;
    500230.832877, 5400611.448050, 89.060070;
    500257.751428, 5400766.378057, 92.900620;
    500032.660865, 5400397.196187, 88.668364;
    500809.733408, 5400667.542332, 109.238530;
    500680.962309, 5400261.102434, 110.612063;
    500291.392001, 5400598.055384, 92.565125;
    500503.292551, 5400394.939276, 100.071785;
    500848.624516, 5400735.623283, 100.166071;
    500481.490284, 5400342.139243, 98.946481;
    500360.400673, 5400200.983154, 90.906232;
    500540.611343, 5400427.697593, 100.187573;
    500408.078766, 5400292.631819, 92.840858;
    500074.012127, 5400443.807205, 81.691736;
    500720.143710, 5400336.628164, 109.762473;
    500392.316208, 5400527.085463, 99.974862;
    500625.354371, 5400976.283204, 89.066281;
    500485.415251, 5400094.577193, 99.919570;
    500350.107964, 5400057.178550, 107.538687;
    500501.939437, 5400335.034074, 100.119581;
    500375.914052, 5400334.383322, 93.032639;
    500607.013926, 5400494.697253, 99.789392;
    500141.421129, 5400439.164142, 82.634920;
    500599.852483, 5400880.437519, 102.365426;
    500785.884582, 5400339.027702, 109.990351;
    500731.162348, 5400287.602468, 109.783717;
    500362.039450, 5400792.876521, 90.660299;
    500884.980751, 5400826.897864, 86.870839;
    500638.374201, 5400159.172726, 106.169777;
    500437.784686, 5400014.996010, 106.413441;
    500221.975605, 5400455.758735, 87.897620;
];

fprintf('Golden reference: 